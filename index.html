<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŒ¿åç•™è¨€æ¿</title>
    <script src="https://www.gstatic.com/firebasejs/10.0.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.0.0/firebase-firestore.js"></script>
</head>

<body>
    <h2>åŒ¿åç•™è¨€æ¿</h2>
    
    <input type="text" id="nameInput" placeholder="ä½ çš„åç¨± (å¯ç•™ç©º)">
    <br>
    <textarea id="message" placeholder="è¼¸å…¥ä½ çš„ç•™è¨€..."></textarea>
    <br>
    <button id="submitBtn">æäº¤</button>

    <ul id="messagesList"></ul>

    <script>
        // ğŸ”¥ åˆå§‹åŒ– Firebase
        const firebaseConfig = {
            apiKey: process.env.REACT_APP_FIREBASE_API_KEY,
            authDomain: process.env.REACT_APP_FIREBASE_AUTH_DOMAIN,
            projectId: process.env.REACT_APP_FIREBASE_PROJECT_ID,
            storageBucket: process.env.REACT_APP_STORAGE_BUCKET,
            messagingSenderId: process.env.REACT_APP_FIREBASE_MESSAGING_SENDER_ID,
            appId: process.env.REACT_APP_FIREBASE_APP_ID

            };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // ğŸš€ ç™¼é€ç•™è¨€å‡½å¼
        function sendMessage() {
            const name = document.getElementById("nameInput").value.trim();
            const message = document.getElementById("message").value.trim();

            if (!message) {
                alert("è«‹è¼¸å…¥ç•™è¨€å…§å®¹ï¼");
                return;
            }

            db.collection("messages").add({
                name: name || "åŒ¿å",  // å¦‚æœæ²’æœ‰è¼¸å…¥åç¨±ï¼Œå°±é è¨­ç‚ºã€ŒåŒ¿åã€
                content: message,
                timestamp: firebase.firestore.FieldValue.serverTimestamp()
            }).then(() => {
                document.getElementById("message").value = "";
            }).catch((error) => {
                console.error("Error adding message: ", error);
            });
        }

        // ğŸ”¹ ç¶å®šæŒ‰éˆ•é»æ“Šäº‹ä»¶
        document.getElementById("submitBtn").addEventListener("click", sendMessage);

        // ğŸ”¹ è®€å–ä¸¦é¡¯ç¤ºç•™è¨€ï¼ˆå³æ™‚æ›´æ–°ï¼‰
        db.collection("messages").orderBy("timestamp", "desc").onSnapshot(snapshot => {
            const list = document.getElementById("messagesList");
            list.innerHTML = "";
            snapshot.forEach(doc => {
                let li = document.createElement("li");
                let data = doc.data();
                li.textContent = `${data.name}: ${data.content}`;
                list.appendChild(li);
            });
        });
    </script>
</body>

</html>
